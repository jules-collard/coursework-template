---
title: "Coursework Template"
subtitle: 'MSc in Statistics 2025/26, Imperial College London'
author: "Jules Lanari-Collard"
format:
  html:
    toc: true
    highlight: tango
    self-contained: true
    df-print: paged
  pdf: default
  gfm: default
format-links: false
bibliography: "MSc_Statistics_coursework_template_quarto.bib" 
---

<style type="text/css">
h1{
  font-size: 24pt;
}
h2{
  font-size: 18pt;
}
body{
  font-size: 12pt;
}
</style>

```{r}
#| label: setup
#| include: false

knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
include_solutions <- TRUE
```

```{r}
#| label: package-imports
#| include: false

require(rmarkdown)
require(knitr)
require(kableExtra)
require(tidyverse)
```

## Exploratory Data Analysis

We will investigate the _penguins_ dataset provided in the `palmerpenguins` R package [@palmer-penguins]. First, @tbl-penguins shows the structure of the data:

```{r}
#| label: tbl-penguins
#| echo: false
#| tbl-cap: Sample of Penguins Dataset

penguins <- palmerpenguins::penguins
penguins %>%
  head() %>%
  kable(
    col.names=c('Species', 'Island', 'Bill Length (mm)', 'Bill Depth (mm)', 'Flipper Length (mm)', 'Body Mass (g)', 'Sex', 'Year')
  )
```

Each row represents a penguin, for which we have information on its dimensions, species, location and more. We see that some of the rows contain missing data, so we can add a column showing whether each row contains any missing data:

```{r}
#| label: add-missing

penguins <- penguins %>%
  mutate(missing = if_any(everything(), is.na))
```

We can calculate some statistics for each species:

```{r}
#| label: means
#| echo: FALSE

penguins %>%
  filter(missing == FALSE) %>%
  group_by(species) %>%
  summarise(avg_bill_length = mean(bill_length_mm, na.rm = TRUE),
            avg_flipper_length = mean(flipper_length_mm, na.rm = TRUE)) %>%
  kable(
    col.names=c('Species', 'Avg Bill Length (mm)', 'Avg Flipper Length (mm)'),
    digits=2
  )
```

## Plots

We examine the relationship between body mass and flipper length, grouping by species, in @fig-mass-flipper :

```{r}
#| label: fig-mass-flipper
#| echo: false
#| warning: false

penguins %>%
  ggplot(mapping = aes(x = body_mass_g,
                       y = flipper_length_mm,
                       col = species,
                       shape = species)) +
  geom_point() +
  labs(x = 'Body Mass (g)', y = 'Flipper Length (mm)', colour = 'Species', shape = 'Species') +
  theme_bw()
```

We can add points for the means in @fig-means :

```{r}
#| label: fig-means
#| echo: false
#| warning: false

means <- penguins %>%
  group_by(species) %>%
  summarise(flipper_length_mm = mean(flipper_length_mm, na.rm=TRUE),
            body_mass_g = mean(body_mass_g, na.rm=TRUE))

ggplot(data = penguins, mapping = aes(x = body_mass_g,
                                     y = flipper_length_mm,
                                     col = species,
                                     shape = species)) +
  geom_point(alpha = 0.5) +
  geom_point(data=means, size=5) +
  labs(x = 'Body Mass (g)', y = 'Flipper Length (mm)', colour = 'Species', shape = 'Species') +
  theme_bw()
```

Finally we compare body mass between islands and species in @fig-boxplots :

```{r}
#| layout-ncol: 2
#| label: fig-boxplots
#| echo: false
#| warning: false
#| fig-cap: "Means Comparison Plots"
#| fig-subcap: 
#| - "Comparison by Island"
#| - "Comparison by Species"

penguins %>%
  ggplot(mapping = aes(x = island, y = body_mass_g)) +
  geom_boxplot() +
  theme_bw()

penguins %>%
  ggplot(mapping = aes(x = species, y = body_mass_g)) +
  geom_boxplot() +
  theme_bw()
```


## Code appendix

```{r ref.label=knitr::all_labels(), echo = T, eval = F}
```

## References
